<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBP Nara Quest Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans', 'Noto Sans JP', sans-serif;
            background-color: #FFF8DC; /* Cornsilk */
            overflow-x: hidden;
        }
        .leaf {
            position: fixed;
            top: -10%;
            z-index: -1;
            opacity: 0.6;
            animation: fall linear infinite;
        }
        @keyframes fall {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(100px, 110vh) rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- Data ---
        // Íµ¨Í∏ÄÎßµ ÎßÅÌÅ¨Îäî Ïã§Ï†ú Ïû•ÏÜåÏùò Í≥µÏú† ÎßÅÌÅ¨(URL)Î•º ÏÇ¨Ïö©Ìï©ÎãàÎã§.
        const stages = [
            {
                id: 'start',
                type: 'start',
                location: "Kofukuji (Start)",
                locationJp: "ËààÁ¶èÂØ∫ (Âá∫Áô∫)",
                mapUrl: "https://www.google.com/maps/search/?api=1&query=Kofukuji+Nara", 
                missionTitle: "Red Power Pose",
                missionJp: "Êú±Ëâ≤„ÅÆ‰∏≠ÈáëÂ†Ç„ÇíËÉåÊôØ„Å´„ÄÅ„ÉÅ„Éº„É†ÂÖ®Âì°„Åß„Äå‰∏ÄÁï™Ëá™‰ø°„ÅÆ„ÅÇ„Çã„Éù„Éº„Ç∫„Äç„ÇíÊ±∫„ÇÅ„Å¶ÈõÜÂêàÂÜôÁúü„ÇíÊíÆ„Å£„Å¶„Åè„Å†„Åï„ÅÑÔºÅ",
                missionEn: "Take a group photo with the red \"Central Golden Hall\" in the background. Everyone must strike their \"Most Confident Pose\"!",
                guideJp: "ËààÁ¶èÂØ∫„ÅØËó§ÂéüÊ∞è„ÅÆÊ∞èÂØ∫„Åß„Åô„ÄÇÊúâÂêç„Å™‰∫îÈáçÂ°î„ÅØÁèæÂú®Â∑•‰∫ã‰∏≠„Åß„Åô„Åå„ÄÅ‰ΩïÂ∫¶„ÇÇÂÜçÂª∫„Åï„Çå„ÅüÊ≠¥Âè≤„ÇíÊåÅ„Å°„Åæ„Åô„ÄÇ",
                guideEn: "Kofukuji was the family temple of the powerful Fujiwara clan. The Five-Story Pagoda is under repair, but has a history of resilience."
            },
            {
                id: 'park',
                type: 'spot',
                location: "Nara Park",
                locationJp: "Â•àËâØÂÖ¨Âúí",
                mapUrl: "https://www.google.com/maps/search/?api=1&query=Nara+Park", 
                missionTitle: "Polite Deer",
                missionJp: "Èπø„Å´„ÅäËæûÂÑÄ„Çí„Åó„ÅüÊôÇ„ÄÅ„Éö„Ç≥„Å£„Å®„ÅäËæûÂÑÄ„ÇíËøî„Åó„Å¶„Åè„Çå„Çã„ÄåÁ§ºÂÑÄÊ≠£„Åó„ÅÑÈπø„Äç„ÇíÊé¢„Åó„Å¶ÂãïÁîª„Å´ÊíÆ„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",
                missionEn: "Find a polite deer that bows back to you when you bow to it. Record it on video!",
                guideJp: "Â•àËâØ„ÅÆÈπø„ÅØÁ•ûÊßò„ÅÆ‰Ωø„ÅÑ„Å®„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„ÅäËæûÂÑÄ„ÅØÈ§å„Çí„Å≠„Å†„ÇãË°åÂãï„Åß„Åô„Åå„ÄÅÁ§ºÂÑÄÊ≠£„Åó„ÅèË¶ã„Åà„Åæ„Åô„Å≠„ÄÇ",
                guideEn: "Deer in Nara are considered messengers of gods. Bowing is how they beg for food, but it looks very polite!"
            },
            {
                id: 'gate',
                type: 'spot',
                location: "Todaiji (Nandaimon)",
                locationJp: "Êù±Â§ßÂØ∫„ÉªÂçóÂ§ßÈñÄ",
                mapUrl: "https://www.google.com/maps/search/?api=1&query=Todaiji+Nandaimon",
                missionTitle: "Face Mimic 'Nio'",
                missionJp: "ÂçóÂ§ßÈñÄ„ÅÆÈáëÂâõÂäõÂ£´ÂÉè„ÅÆË°®ÊÉÖ„Å®Êâã„ÅÆÂãï„Åç„Çí„ÄÅ„Ç∑„É≥„ÇØ„É≠Áéá100%„ÅßÁúü‰ºº„Åó„Å¶ÊíÆ„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",
                missionEn: "At the Great South Gate, take a photo mimicking the facial expression and hand gestures of the Nio Guardian Statue perfectly!",
                guideJp: "ÈÅãÊÖ∂„Å®Âø´ÊÖ∂„Åå‰Ωú„Å£„ÅüÂ∑®Â§ß„Å™ÂÆàË≠∑Á•û„Åß„Åô„ÄÇÂè£„ÇíÈñã„Åë„Åü„ÄåÈòø„Äç„Å®Èñâ„Åò„Åü„ÄåÂêΩ„Äç„ÅØÂÆáÂÆô„ÅÆÂßã„Åæ„Çä„Å®ÁµÇ„Çè„Çä„ÇíË°®„Åó„Åæ„Åô„ÄÇ",
                guideEn: "Massive guardians by Unkei & Kaikei. The open mouth ('A') and closed mouth ('Un') represent the universe's beginning and end."
            },
            {
                id: 'buddha',
                type: 'spot',
                location: "Todaiji (Great Buddha)",
                locationJp: "Êù±Â§ßÂØ∫„ÉªÂ§ß‰ªèÊÆø",
                mapUrl: "https://www.google.com/maps/search/?api=1&query=Todaiji+Daibutsuden",
                missionTitle: "Buddha's Palm Quiz",
                missionJp: "Â§ß‰ªèÊÆø„ÅÆÊ°àÂÜÖÊùø„ÇíË¶ã„Å¶Á≠î„Åà„ÇíÊé¢„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇQ:„ÄåÂ§ß‰ªèÊßò„ÅÆ‰∏≠Êåá„ÅÆÈï∑„Åï„ÅØ„ÄÅÁ¥Ñ‰Ωï„É°„Éº„Éà„É´Ôºü„Äç",
                missionEn: "Find the answer inside. Q: \"How many meters long is the Great Buddha's middle finger?\"",
                guideJp: "‰∏ñÁïåÊúÄÂ§ßÁ¥ö„ÅÆÊú®ÈÄ†Âª∫ÁØâ„Åß„Åô„ÄÇÂ§ß‰ªèÊßò„ÅÆÈ†≠„ÅØÊ±üÊà∏ÊôÇ‰ª£„Å´‰øÆÁêÜ„Åï„Çå„Åü„ÇÇ„ÅÆ„Åß„ÄÅ‰Ωì„Å®Ëâ≤„ÅåÂ∞ë„ÅóÈÅï„ÅÑ„Åæ„Åô„ÄÇ",
                guideEn: "One of the world's largest wooden buildings. The head was repaired in the Edo period, so its color is slightly different."
            },
            {
                id: 'nigatsudo',
                type: 'spot',
                location: "Nigatsudo",
                locationJp: "‰∫åÊúàÂ†Ç",
                mapUrl: "https://www.google.com/maps/search/?api=1&query=Nigatsudo",
                missionTitle: "The Back of Youth",
                missionJp: "Â•àËâØÂ∏ÇÂÜÖ„ÅåË¶ãÊ∏°„Åõ„ÇãËàûÂè∞„Åß„ÄÅ„Äå„ÉÅ„Éº„É†ÂÖ®Âì°„ÅÆÂæå„ÇçÂßø„Äç„ÇíÊíÆ„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÊâã„ÇÑËÖï„Çí‰Ωø„Å£„Å¶‰∏Ä„Å§„ÅÆÂΩ¢„Çí‰Ωú„Çã„Åì„Å®ÔºÅ",
                missionEn: "Take a photo of \"everyone's back\" on the balcony. You must use your hands/arms to make a shape together!",
                guideJp: "„Äå„ÅäÊ∞¥Âèñ„Çä„Äç„ÅßÊúâÂêç„Å™„ÅäÂ†Ç„Åß„Åô„ÄÇ„Åì„Åì„Åã„ÇâË¶ã„ÇãÂ§ïÊó•„ÅØÁµ∂ÊôØ„Åß„Åô„ÄÇ",
                guideEn: "Famous for the 'Omizutori' festival. The sunset view from this balcony is breathtaking."
            },
            {
                id: 'goal',
                type: 'goal',
                location: "Sarusawa Pond (Goal)",
                locationJp: "ÁåøÊ≤¢Ê±† („Ç¥„Éº„É´)",
                mapUrl: "https://www.google.com/maps/search/?api=1&query=Sarusawa+Pond",
                missionTitle: "Finish Line Jump",
                missionJp: "Ê±†„ÇíËÉåÊôØ„Å´„ÄÅÂñú„Å≥„ÅÆ„ÄåÂÆåËµ∞„Ç∏„É£„É≥„ÉóÂÜôÁúü„Äç„ÇíÊíÆ„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÔºàÁñ≤„Çå„Åü„ÉÅ„Éº„É†„ÅØ‰∫Ä„ÅÆÂÜôÁúü„Åß„ÇÇOKÔºâ",
                missionEn: "Take a \"Group Jump Shot\" with the pond in the background! (Tired teams can take a photo of a turtle instead.)",
                guideJp: "ËààÁ¶èÂØ∫„ÅÆ‰∫îÈáçÂ°î„ÅåÊò†„ÇãÊ±†„Åß„Åô„ÄÇ‰∫Ä„Åå„Åü„Åè„Åï„ÇìÊó•Âêë„Åº„Å£„Åì„Çí„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
                guideEn: "Famous for the reflection of the pagoda. You can see many turtles sunbathing here."
            }
        ];

        const BonusMission = {
            title: "BONUS MISSION",
            missionTitle: "Global Team",
            missionJp: "Â•àËâØÂÖ¨ÂúíÂÜÖ„Åß4„É∂ÂõΩË™ûÔºàÊó•„ÉªËã±„ÉªÈüì„Éª‰∏≠Ôºâ„ÅåÊõ∏„Åã„Çå„ÅüÁúãÊùø„ÇíÊé¢„Åó„ÄÅ„Åø„Çì„Å™„ÅßÊåáÂ∑Æ„Åó„Å¶ÊíÆÂΩ±„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",
            missionEn: "Find a signboard written in 4 languages (JP/EN/KR/CN). Take a photo pointing at it together."
        };

        // --- Components ---

        function AutumnLeaves() {
            const leaves = Array.from({ length: 15 }).map((_, i) => {
                const style = {
                    left: `${Math.random() * 100}vw`,
                    animationDuration: `${5 + Math.random() * 10}s`,
                    animationDelay: `${Math.random() * 5}s`,
                    color: ['#8B0000', '#D2691E', '#DAA520'][Math.floor(Math.random() * 3)],
                    fontSize: `${10 + Math.random() * 20}px`
                };
                const type = Math.random() > 0.5 ? 'üçÅ' : 'üçÇ'; 
                return <div key={i} className="leaf" style={style}>{type}</div>;
            });
            return <>{leaves}</>;
        }

        function AccordionCard({ stage, icon, colorClass, borderColorClass }) {
            const [isOpen, setIsOpen] = useState(false);

            return (
                <div className={`bg-white rounded-xl shadow-md mb-4 overflow-hidden border-l-8 ${borderColorClass} bg-opacity-95`}>
                    {/* Header */}
                    <button 
                        onClick={() => setIsOpen(!isOpen)}
                        className="w-full text-left p-4 flex justify-between items-center hover:bg-gray-50 transition-colors relative"
                    >
                        <div className="flex items-center gap-3 w-full pr-8">
                            <div className={`flex-shrink-0 flex items-center justify-center w-10 h-10 ${colorClass} text-white rounded-full shadow-sm text-xl`}>
                                {icon}
                            </div>
                            <div className="flex-grow">
                                <h3 className="font-bold text-gray-800 text-lg leading-tight">{stage.location}</h3>
                                <p className="text-xs text-gray-500 font-medium">{stage.locationJp}</p>
                            </div>
                        </div>
                        <div className={`transform transition-transform duration-300 text-gray-400 absolute right-4 top-1/2 -translate-y-1/2 ${isOpen ? 'rotate-180' : ''}`}>
                            ‚ñº
                        </div>
                    </button>

                    {/* Content */}
                    <div className={`transition-all duration-300 ease-in-out overflow-hidden ${isOpen ? 'max-h-[600px] opacity-100' : 'max-h-0 opacity-0'}`}>
                        <div className="p-4 border-t border-gray-100 bg-white">
                            
                            {/* UPDATED: Map Link Card Style */}
                            <a href={stage.mapUrl} target="_blank" rel="noopener noreferrer" className="block w-full mb-4 group">
                                <div className="bg-blue-50 border border-blue-200 rounded-xl p-3 flex items-center gap-3 hover:bg-blue-100 transition shadow-sm">
                                    <div className="bg-white p-2 rounded-full text-xl shadow-sm group-hover:scale-110 transition-transform">üó∫Ô∏è</div>
                                    <div className="text-left flex-grow">
                                        <div className="text-blue-800 font-bold text-sm">Open in Google Maps</div>
                                        <div className="text-blue-500 text-xs">ÁèæÂú®Âú∞„Åã„Çâ„ÅÆ„É´„Éº„Éà„ÇíË¶ã„Çã (Navigation)</div>
                                    </div>
                                    <div className="text-blue-400 font-bold text-lg">‚û§</div>
                                </div>
                            </a>

                            {/* Mission */}
                            <div className="mb-4">
                                <h4 className="text-sm font-black text-[#D2691E] uppercase tracking-wide mb-2 flex items-center gap-2">
                                    <span>üì∏</span> Mission: {stage.missionTitle}
                                </h4>
                                <div className="space-y-2 text-sm">
                                    <div className="bg-red-50 p-3 rounded-md border-l-4 border-red-400">
                                        <p className="text-gray-800 font-medium">{stage.missionJp}</p>
                                    </div>
                                    <div className="bg-blue-50 p-3 rounded-md border-l-4 border-blue-400">
                                        <p className="text-gray-800 font-medium">{stage.missionEn}</p>
                                    </div>
                                </div>
                            </div>

                            {/* Guide */}
                            <div className="bg-[#FFFDE7] p-3 rounded-lg border border-yellow-200">
                                <h5 className="text-xs font-bold text-yellow-700 mb-1 flex items-center gap-1">
                                    <span>üí°</span> Did You Know?
                                </h5>
                                <p className="text-xs text-gray-700 mb-1"><strong className="text-gray-900">[JP]</strong> {stage.guideJp}</p>
                                <p className="text-xs text-gray-700"><strong className="text-gray-900">[EN]</strong> {stage.guideEn}</p>
                            </div>

                        </div>
                    </div>
                </div>
            );
        }

        function App() {
            // Grouping logic
            const startStage = stages.find(s => s.type === 'start');
            const spotStages = stages.filter(s => s.type === 'spot');
            const goalStage = stages.find(s => s.type === 'goal');

            return (
                <div className="min-h-screen pb-20 relative">
                    <AutumnLeaves />
                    
                    {/* Header */}
                    <header className="bg-[#8B0000] text-white p-6 rounded-b-3xl shadow-xl mb-6 relative overflow-hidden">
                        <div className="relative z-10">
                            <h1 className="text-3xl font-black mb-1">NARA QUEST</h1>
                            <div className="w-16 h-1 bg-[#DAA520] mb-2 rounded-full"></div>
                            <p className="text-[#DAA520] font-bold text-sm">BBP International Walking Rally Guide</p>
                            <p className="text-xs opacity-75 mt-1">2025.12.14 | Kyoto ‚Üí Nara</p>
                        </div>
                    </header>

                    <div className="max-w-md mx-auto px-4">
                        
                        {/* 1. Rules Card */}
                        <div className="mb-4 bg-white bg-opacity-90 p-4 rounded-xl shadow-sm border border-gray-200">
                            <h3 className="font-bold text-[#8B0000] mb-2 flex items-center gap-2 border-b pb-2">
                                <span>üìú</span> GAME RULES
                            </h3>
                            <ul className="text-sm text-gray-700 space-y-1 list-disc pl-4">
                                <li><strong>Start & Goal</strong> are fixed.</li>
                                <li><strong>Adventure Spots:</strong> Visit in <span className="text-red-600 font-bold bg-red-100 px-1 rounded">ANY ORDER!</span></li>
                                <li><strong>Time Limit:</strong> Arrive at Goal by <span className="font-bold text-red-600">15:30</span>.</li>
                            </ul>
                        </div>

                        {/* 2. Safety & Etiquette Card (New Separate Section) */}
                        <div className="mb-8 bg-red-50 p-4 rounded-xl shadow-sm border border-red-200">
                            <h3 className="font-bold text-red-600 mb-2 flex items-center gap-2 border-b border-red-200 pb-2">
                                <span>‚ö†Ô∏è</span> SAFETY & ETIQUETTE
                            </h3>
                            <ul className="text-sm text-gray-700 space-y-2">
                                <li className="flex gap-2 items-start">
                                    <span className="text-lg">ü¶å</span>
                                    <span>
                                        <strong>Deer Safety:</strong><br/>
                                        Deer eat paper! Hide your maps & money.<br/>
                                        <span className="text-xs text-gray-500">Á¥ôÈ°ûÔºàÂú∞Âõ≥„ÇÑ„ÅäÊú≠Ôºâ„ÅØÈπø„Å´È£ü„Åπ„Çâ„Çå„Åæ„Åô„ÄÇÈö†„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºÅ</span>
                                    </span>
                                </li>
                                <li className="flex gap-2 items-start">
                                    <span className="text-lg">üõë</span>
                                    <span>
                                        <strong>No Teasing:</strong><br/>
                                        Give crackers quickly. If empty, show hands (üôå).
                                    </span>
                                </li>
                                <li className="flex gap-2 items-start">
                                    <span className="text-lg">üóëÔ∏è</span>
                                    <span>
                                        <strong>Trash:</strong> Please take all trash with you.<br/>
                                        <span className="text-xs text-gray-500">„Ç¥„Éü„ÅØÂêÑËá™ÊåÅ„Å°Â∏∞„Çä„Åæ„Åó„Çá„ÅÜ„ÄÇ</span>
                                    </span>
                                </li>
                            </ul>
                        </div>

                        {/* 3. START Section */}
                        <div className="mb-2 pl-2 border-l-4 border-red-800">
                            <h2 className="text-sm font-bold text-gray-500 uppercase tracking-widest">Start Point (12:30)</h2>
                        </div>
                        <AccordionCard 
                            stage={startStage} 
                            icon="üö©" 
                            colorClass="bg-red-600" 
                            borderColorClass="border-red-600" 
                        />

                        {/* 4. ADVENTURE Section */}
                        <div className="mt-8 mb-2 pl-2 border-l-4 border-orange-500 flex justify-between items-center">
                            <h2 className="text-sm font-bold text-gray-500 uppercase tracking-widest">Adventure Zone</h2>
                            <span className="text-[10px] bg-orange-100 text-orange-600 px-2 py-1 rounded-full font-bold">FREE ORDER</span>
                        </div>
                        
                        <div className="space-y-3">
                            {spotStages.map(stage => (
                                <AccordionCard 
                                    key={stage.id} 
                                    stage={stage} 
                                    icon="üìç" 
                                    colorClass="bg-orange-500" 
                                    borderColorClass="border-orange-500" 
                                />
                            ))}
                        </div>

                        {/* 5. GOAL Section */}
                        <div className="mt-8 mb-2 pl-2 border-l-4 border-green-600">
                            <h2 className="text-sm font-bold text-gray-500 uppercase tracking-widest">Goal (15:30)</h2>
                        </div>
                        <AccordionCard 
                            stage={goalStage} 
                            icon="üèÅ" 
                            colorClass="bg-green-600" 
                            borderColorClass="border-green-600" 
                        />

                        {/* Bonus */}
                        <div className="mt-8">
                            <div className="bg-gradient-to-r from-yellow-400 to-orange-400 p-4 rounded-xl shadow-lg text-white border-2 border-white">
                                <h3 className="font-bold text-lg mb-1 flex items-center gap-2">
                                    <span>üåü</span> {BonusMission.title}
                                </h3>
                                <p className="text-sm font-medium mb-3 opacity-90">{BonusMission.missionTitle}</p>
                                <div className="bg-white bg-opacity-20 p-3 rounded-lg text-sm backdrop-blur-sm">
                                    <p className="mb-1">{BonusMission.missionJp}</p>
                                    <p className="opacity-80 text-xs">{BonusMission.missionEn}</p>
                                </div>
                            </div>
                        </div>

                        {/* Footer */}
                        <div className="text-center text-gray-400 text-xs py-10">
                            <p>Safety First & Have Fun!</p>
                            <p>BBP 2025 Winter</p>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>